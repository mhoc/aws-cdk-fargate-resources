"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.FargateResourcePie = exports.FargateResources = void 0;
class FargateResources {
    constructor(cpuRaw, memoryRaw) {
        this.cpu = {
            all: -1,
            take: (n) => {
                if (n < 1) {
                    return Math.floor(this.cpu.all * n);
                }
                n = Math.floor(n);
                if (n > this.cpu.all) {
                    throw new Error(`Requested cpu value ${n} exceeds total cpu available (${this.cpu.all}).`);
                }
                return n;
            },
            pie: () => new FargateResourcePie("cpu", this.cpu.all),
        };
        this.memory = {
            all: -1,
            take: (n) => {
                if (n < 1) {
                    return Math.floor(this.memory.all * n);
                }
                n = Math.floor(n);
                if (n > this.memory.all) {
                    throw new Error(`Requested memory value ${n} exceeds total memory available (${this.cpu.all}).`);
                }
                return n;
            },
            pie: () => new FargateResourcePie("memory", this.memory.all),
        };
        if (cpuRaw <= 0) {
            throw new Error("FargateResources instantiated with negative cpu value");
        }
        if (memoryRaw <= 0) {
            throw new Error("FargateResources instantiated with negative memory value");
        }
        this.cpu.all = cpuRaw;
        this.memory.all = memoryRaw;
    }
}
exports.FargateResources = FargateResources;
FargateResources.cpu250m = {
    mem512m: new FargateResources(250, 512),
    mem1g: new FargateResources(250, 1024),
    mem2g: new FargateResources(250, 2048),
};
FargateResources.cpu500m = {
    mem1g: new FargateResources(500, 1024),
    mem2g: new FargateResources(500, 2048),
    mem3g: new FargateResources(500, 3072),
    mem4g: new FargateResources(500, 4096),
};
FargateResources.cpu1 = {
    mem2g: new FargateResources(1000, 2048),
    mem3g: new FargateResources(1000, 3072),
    mem4g: new FargateResources(1000, 4096),
    mem5g: new FargateResources(1000, 5120),
    mem6g: new FargateResources(1000, 6144),
    mem7g: new FargateResources(1000, 7168),
    mem8g: new FargateResources(1000, 8192),
};
FargateResources.cpu2 = {
    mem4g: new FargateResources(2000, 4096),
    mem5g: new FargateResources(2000, 5120),
    mem6g: new FargateResources(2000, 6144),
    mem7g: new FargateResources(2000, 7168),
    mem8g: new FargateResources(2000, 8192),
    mem9g: new FargateResources(2000, 9216),
    mem10g: new FargateResources(2000, 10240),
    mem11g: new FargateResources(2000, 11264),
    mem12g: new FargateResources(2000, 12288),
    mem13g: new FargateResources(2000, 13312),
    mem14g: new FargateResources(2000, 14336),
    mem15g: new FargateResources(2000, 15360),
    mem16g: new FargateResources(2000, 16384),
};
FargateResources.cpu4 = {
    mem8g: new FargateResources(4000, 8192),
    mem9g: new FargateResources(4000, 9216),
    mem10g: new FargateResources(4000, 10240),
    mem11g: new FargateResources(4000, 11264),
    mem12g: new FargateResources(4000, 12288),
    mem13g: new FargateResources(4000, 13312),
    mem14g: new FargateResources(4000, 14336),
    mem15g: new FargateResources(4000, 15360),
    mem16g: new FargateResources(4000, 16384),
    mem17g: new FargateResources(4000, 17408),
    mem18g: new FargateResources(4000, 18432),
    mem19g: new FargateResources(4000, 19456),
    mem20g: new FargateResources(4000, 20480),
    mem21g: new FargateResources(4000, 21504),
    mem22g: new FargateResources(4000, 22528),
    mem23g: new FargateResources(4000, 23552),
    mem24g: new FargateResources(4000, 24576),
    mem25g: new FargateResources(4000, 25600),
    mem26g: new FargateResources(4000, 26624),
    mem27g: new FargateResources(4000, 27648),
    mem28g: new FargateResources(4000, 28672),
    mem29g: new FargateResources(4000, 29696),
    mem30g: new FargateResources(4000, 30720),
};
class FargateResourcePie {
    constructor(label, total) {
        this.label = label;
        this.total = total;
        if (total < 0) {
            throw new Error("FargateResourcePie instantiated with negative value");
        }
        this.remaining = total;
    }
    rest() {
        const _remaining = this.remaining;
        this.remaining = 0;
        return _remaining;
    }
    take(n) {
        if (n < 1) {
            const desired = Math.floor(this.total * n);
            if (desired > this.remaining) {
                throw new Error(`Requested ${this.label} proportion ${n} exceeds remaining ${this.label} available (${desired} > ${this.remaining}).`);
            }
            this.remaining -= desired;
            return desired;
        }
        n = Math.floor(n);
        if (n > this.remaining) {
            throw new Error(`Requested ${this.label} value ${n} exceeds remaining ${this.label} available (${this.remaining}).`);
        }
        this.remaining -= n;
        return n;
    }
}
exports.FargateResourcePie = FargateResourcePie;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxNQUFhLGdCQUFnQjtJQTRGM0IsWUFBWSxNQUFjLEVBQUUsU0FBaUI7UUE5QjdCLFFBQUcsR0FBRztZQUNwQixHQUFHLEVBQUUsQ0FBQyxDQUFDO1lBQ1AsSUFBSSxFQUFFLENBQUMsQ0FBUyxFQUFVLEVBQUU7Z0JBQzFCLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRTtvQkFDVCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUM7aUJBQ3JDO2dCQUNELENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNsQixJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRTtvQkFDcEIsTUFBTSxJQUFJLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQyxpQ0FBaUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDO2lCQUM1RjtnQkFDRCxPQUFPLENBQUMsQ0FBQztZQUNYLENBQUM7WUFDRCxHQUFHLEVBQUUsR0FBdUIsRUFBRSxDQUFDLElBQUksa0JBQWtCLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDO1NBQzNFLENBQUM7UUFFYyxXQUFNLEdBQUc7WUFDdkIsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUNQLElBQUksRUFBRSxDQUFDLENBQVMsRUFBVSxFQUFFO2dCQUMxQixJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUU7b0JBQ1QsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDO2lCQUN4QztnQkFDRCxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbEIsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUU7b0JBQ3ZCLE1BQU0sSUFBSSxLQUFLLENBQUMsMEJBQTBCLENBQUMsb0NBQW9DLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztpQkFDbEc7Z0JBQ0QsT0FBTyxDQUFDLENBQUM7WUFDWCxDQUFDO1lBQ0QsR0FBRyxFQUFFLEdBQXVCLEVBQUUsQ0FBQyxJQUFJLGtCQUFrQixDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQztTQUNqRixDQUFDO1FBR0EsSUFBSSxNQUFNLElBQUksQ0FBQyxFQUFFO1lBQ2YsTUFBTSxJQUFJLEtBQUssQ0FBQyx1REFBdUQsQ0FBQyxDQUFDO1NBQzFFO1FBQ0QsSUFBSSxTQUFTLElBQUksQ0FBQyxFQUFFO1lBQ2xCLE1BQU0sSUFBSSxLQUFLLENBQUMsMERBQTBELENBQUMsQ0FBQztTQUM3RTtRQUNELElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLE1BQU0sQ0FBQztRQUN0QixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxTQUFTLENBQUM7SUFDOUIsQ0FBQzs7QUFyR0gsNENBdUdDO0FBdEd3Qix3QkFBTyxHQUFHO0lBQy9CLE9BQU8sRUFBRSxJQUFJLGdCQUFnQixDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7SUFDdkMsS0FBSyxFQUFFLElBQUksZ0JBQWdCLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQztJQUN0QyxLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDO0NBQ3ZDLENBQUM7QUFDcUIsd0JBQU8sR0FBRztJQUMvQixLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDO0lBQ3RDLEtBQUssRUFBRSxJQUFJLGdCQUFnQixDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUM7SUFDdEMsS0FBSyxFQUFFLElBQUksZ0JBQWdCLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQztJQUN0QyxLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDO0NBQ3ZDLENBQUM7QUFDcUIscUJBQUksR0FBRztJQUM1QixLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQ3ZDLEtBQUssRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7SUFDdkMsS0FBSyxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztJQUN2QyxLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQ3ZDLEtBQUssRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7SUFDdkMsS0FBSyxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztJQUN2QyxLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO0NBQ3hDLENBQUM7QUFDcUIscUJBQUksR0FBRztJQUM1QixLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQ3ZDLEtBQUssRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7SUFDdkMsS0FBSyxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztJQUN2QyxLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQ3ZDLEtBQUssRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7SUFDdkMsS0FBSyxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztJQUN2QyxNQUFNLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDO0lBQ3pDLE1BQU0sRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxLQUFLLENBQUM7SUFDekMsTUFBTSxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQztJQUN6QyxNQUFNLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDO0lBQ3pDLE1BQU0sRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxLQUFLLENBQUM7SUFDekMsTUFBTSxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQztJQUN6QyxNQUFNLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDO0NBQzFDLENBQUM7QUFDcUIscUJBQUksR0FBRztJQUM1QixLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQ3ZDLEtBQUssRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7SUFDdkMsTUFBTSxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQztJQUN6QyxNQUFNLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDO0lBQ3pDLE1BQU0sRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxLQUFLLENBQUM7SUFDekMsTUFBTSxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQztJQUN6QyxNQUFNLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDO0lBQ3pDLE1BQU0sRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxLQUFLLENBQUM7SUFDekMsTUFBTSxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQztJQUN6QyxNQUFNLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDO0lBQ3pDLE1BQU0sRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksRUFBRSxLQUFLLENBQUM7SUFDekMs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